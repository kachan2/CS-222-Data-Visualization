{"ast":null,"code":"import { findMidPointOfPolygon, Rect, filter, getTemplateFunction, getZoomTranslate, getTranslate, RectOption, convertElementFromLabel, Point, TextOption, renderTextElement, textTrim, measureText, Internalize } from '../utils/helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { dataLabelRendering } from '../model/constants';\n/**\n * DataLabel Module used to render the maps datalabel\n */\nvar DataLabel = /** @class */function () {\n  function DataLabel(maps) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.value = {\n      rightWidth: 0,\n      leftWidth: 0,\n      heightTop: 0,\n      heightBottom: 0\n    };\n    this.maps = maps;\n    this.dataLabelCollections = [];\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  DataLabel.prototype.getDataLabel = function (dataSource, labelPath, shapeName, shapeDataPath) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var text;\n    var shapeNameValue;\n    for (var i = 0; i < dataSource.length; i++) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      var data = dataSource[i];\n      var dataShapePathValue = !isNullOrUndefined(data[shapeDataPath]) && isNaN(data[shapeDataPath]) && typeof data[shapeDataPath] === 'string' ? data[shapeDataPath].toLowerCase() : data[shapeDataPath];\n      shapeName = !isNullOrUndefined(shapeName) && typeof shapeName === 'string' ? shapeName.toString() : shapeName;\n      shapeNameValue = !isNullOrUndefined(shapeName) && typeof shapeName === 'string' ? shapeName.toLowerCase() : shapeName;\n      if (dataShapePathValue === shapeNameValue) {\n        text = data;\n        break;\n      }\n    }\n    return text;\n  };\n  /**\n   * To render label for maps\n   *\n   * @param {LayerSettings} layer - Specifies the layer settings\n   * @param {number} layerIndex - Specifies the layer index.\n   * @param {any} shape - Specifies the shape.\n   * @param {any[]} layerData - Specifies the layer data.\n   * @param {Element} group Specifies the element.\n   * @param {HTMLElement} labelTemplateElement - Specifies the template element.\n   * @param {number} index - Specifies the index number.\n   * @param {any[]} intersect - Specifies the intersect.\n   * @returns {void}\n   */\n  DataLabel.prototype.renderLabel = function (\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  layer, layerIndex, shape,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  layerData, group, labelTemplateElement, index, intersect) {\n    var _this = this;\n    var dataLabel = layer.dataLabelSettings;\n    var style = layer.dataLabelSettings.textStyle;\n    var markerEle;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var templateFn;\n    var options;\n    var dataLabelSettings = layer.dataLabelSettings;\n    var labelpath = layer.dataLabelSettings.labelPath;\n    var shapePoint = [[]];\n    var midIndex = 0;\n    var pointsLength = 0;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var shapeData = shape;\n    var element;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var data;\n    var text = '';\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var datasrcObj;\n    var currentLength = 0;\n    var oldIndex;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var location;\n    var sublayerIndexLabel = false;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var shapeProperties = shape['properties'];\n    var labelId = this.maps.element.id + '_LayerIndex_' + layerIndex + '_shapeIndex_' + index + '_LabelIndex_' + index;\n    var textLocation = new Point(0, 0);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var shapes = layerData[index];\n    var locationX;\n    var locationY;\n    style.fontFamily = this.maps.theme.toLowerCase() !== 'material' ? this.maps.themeStyle.labelFontFamily : style.fontFamily;\n    shape = shapes['property'];\n    var properties = Object.prototype.toString.call(layer.shapePropertyPath) === '[object Array]' ? layer.shapePropertyPath : [layer.shapePropertyPath];\n    var propertyPath;\n    var isPoint = false;\n    var animate = layer.animationDuration !== 0 || isNullOrUndefined(this.maps.zoomModule);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var translate = this.maps.isTileMap ? new Object() : this.maps.zoomSettings.zoomFactor > 1 && !isNullOrUndefined(this.maps.zoomModule) ? getZoomTranslate(this.maps, layer, animate) : getTranslate(this.maps, layer, animate);\n    var scale = this.maps.isTileMap ? this.maps.scale : translate['scale'];\n    var transPoint = this.maps.isTileMap ? this.maps.translatePoint : translate['location'];\n    var zoomTransPoint = this.maps.zoomTranslatePoint;\n    var shapeWidth;\n    var scaleZoomValue = !isNullOrUndefined(this.maps.scale) ? Math.floor(this.maps.scale) : 1;\n    var zoomLabelsPosition = this.maps.zoomSettings.enable ? !isNullOrUndefined(this.maps.zoomShapeCollection) && this.maps.zoomShapeCollection.length > 0 && !this.maps.isAddLayer : this.maps.zoomSettings.enable;\n    this.maps.translateType = 'labels';\n    for (var j = 0; j < properties.length; j++) {\n      if (shapeProperties[properties[j]]) {\n        propertyPath = properties[j];\n        datasrcObj = this.getDataLabel(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        layer.dataSource, layer.shapeDataPath, shapeData['properties'][propertyPath], layer.shapeDataPath);\n        if (datasrcObj) {\n          break;\n        }\n      }\n    }\n    datasrcObj = this.getDataLabel(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    layer.dataSource, layer.shapeDataPath, shapeData['properties'][propertyPath], layer.shapeDataPath);\n    if (!isNullOrUndefined(shapes['property'])) {\n      shapePoint = [[]];\n      if (!layerData[index]['_isMultiPolygon'] && layerData[index]['type'] !== 'Point' && layerData[index]['type'] !== 'MultiPoint') {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        shapePoint.push(this.getPoint(layerData[index], []));\n        currentLength = shapePoint[shapePoint.length - 1].length;\n        if (pointsLength < currentLength) {\n          pointsLength = currentLength;\n          midIndex = shapePoint.length - 1;\n        }\n      } else if (layerData[index]['type'] !== 'Point' && layerData[index]['type'] !== 'MultiPoint') {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var layer_1 = layerData[index];\n        for (var j = 0; j < layer_1.length; j++) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          shapePoint.push(this.getPoint(layer_1[j], []));\n          currentLength = shapePoint[shapePoint.length - 1].length;\n          if (pointsLength < currentLength) {\n            pointsLength = currentLength;\n            midIndex = shapePoint.length - 1;\n          }\n        }\n      }\n    }\n    text = !isNullOrUndefined(datasrcObj) ? !isNullOrUndefined(datasrcObj[labelpath]) ? datasrcObj[labelpath].toString() : datasrcObj[layer.shapeDataPath] : shapeData['properties'][labelpath];\n    if (Object.prototype.toString.call(layer.shapePropertyPath) === '[object Array]' && isNullOrUndefined(text) && layer.dataSource['length'] === 0) {\n      for (var l = 0; l < layer.shapePropertyPath.length; l++) {\n        if (shapeData['properties'][layer.shapePropertyPath[l]]) {\n          text = shapeData['properties'][layer.shapePropertyPath[l]];\n          break;\n        }\n      }\n    }\n    if (isNullOrUndefined(text) && layer.dataLabelSettings.template !== '' && layer.dataSource['length'] === 0) {\n      text = shapeData['properties'][layer.shapePropertyPath];\n    }\n    var dataLabelText = text;\n    var projectionType = this.maps.projectionType;\n    if (isPoint) {\n      location = {\n        x: shapePoint[midIndex][index]['x'],\n        y: shapePoint[midIndex][index]['y'],\n        rightMin: 0,\n        rightMax: 0,\n        leftMin: 0,\n        leftMax: 0,\n        points: shapePoint[midIndex][index],\n        topMax: 0,\n        topMin: 0,\n        bottomMax: 0,\n        bottomMin: 0,\n        height: 0\n      };\n    } else {\n      location = findMidPointOfPolygon(shapePoint[midIndex], projectionType, layer.geometryType);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var firstLevelMapLocation = location;\n    if (!isNullOrUndefined(text) && !isNullOrUndefined(location)) {\n      if (zoomLabelsPosition && scaleZoomValue > 1 && !this.maps.zoomNotApplied && dataLabel.template === '') {\n        if (layerIndex > 0) {\n          for (var k = 0; k < this.maps.zoomLabelPositions.length; k++) {\n            if (this.maps.zoomLabelPositions[k]['dataLabelText'] === text) {\n              oldIndex = index;\n              index = k;\n              sublayerIndexLabel = true;\n              break;\n            }\n          }\n        }\n        locationX = location['x'];\n        locationY = location['y'];\n        location['x'] = (location['x'] + zoomTransPoint['x']) * scale;\n        location['y'] = (location['y'] + zoomTransPoint['y']) * scale;\n      }\n      location['y'] = this.maps.projectionType === 'Mercator' || layer.geometryType === 'Normal' ? location['y'] : -location['y'];\n      data = location;\n      if (!isNullOrUndefined(this.maps.format) && !isNaN(parseFloat(text))) {\n        if (this.maps.useGroupingSeparator) {\n          text = Internalize(this.maps, parseFloat(text));\n          if (!isNullOrUndefined(datasrcObj)) {\n            datasrcObj[labelpath] = text;\n          }\n        }\n      }\n      var eventargs_1 = {\n        name: dataLabelRendering,\n        maps: this.maps,\n        cancel: false,\n        border: {\n          color: dataLabel.border.color,\n          width: dataLabel.border.width,\n          opacity: dataLabel.border.opacity\n        },\n        datalabel: dataLabel,\n        fill: dataLabel.fill,\n        template: dataLabel.template,\n        text: text,\n        offsetX: 0,\n        offsetY: 0\n      };\n      this.maps.trigger('dataLabelRendering', eventargs_1, function (labelArgs) {\n        if (eventargs_1.cancel) {\n          return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var border = {\n          color: 'yellow'\n        };\n        var position = [];\n        var width = zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied && _this.maps.zoomShapeCollection.length > index ? _this.maps.zoomShapeCollection[index]['width'] : (location['rightMax']['x'] - location['leftMax']['x']) * scale;\n        if (!isNullOrUndefined(_this.maps.dataLabelShape)) {\n          shapeWidth = firstLevelMapLocation['rightMax']['x'] - firstLevelMapLocation['leftMax']['x'];\n          _this.maps.dataLabelShape.push(shapeWidth);\n        }\n        if (eventargs_1.text !== text && !eventargs_1.cancel) {\n          text = eventargs_1.text;\n        }\n        var textSize = measureText(text, style);\n        var trimmedLable = text;\n        var elementSize = textSize;\n        var startY = location['y'] - textSize['height'] / 4;\n        var endY = location['y'] + textSize['height'] / 4;\n        var start = (location['y'] + transPoint['y']) * scale - textSize['height'] / 4;\n        var end = (location['y'] + transPoint['y']) * scale + textSize['height'] / 4;\n        position = filter(shapePoint[midIndex], startY, endY);\n        if (!isPoint && position.length > 5 && shapeData['geometry']['type'] !== 'MultiPolygon' && shapeData['type'] !== 'MultiPolygon') {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          var location1 = findMidPointOfPolygon(position, projectionType, layer.geometryType);\n          if (zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied && eventargs_1.template === '') {\n            location1['x'] = (_this.maps.zoomLabelPositions[index]['location']['x'] + zoomTransPoint['x']) * scale;\n            location1['y'] = (_this.maps.zoomLabelPositions[index]['location']['y'] + zoomTransPoint['y']) * scale;\n          }\n          locationX = location1['x'];\n          location['x'] = location1['x'];\n          width = zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied && _this.maps.zoomShapeCollection.length > index ? _this.maps.zoomShapeCollection[index]['width'] : (location1['rightMax']['x'] - location1['leftMax']['x']) * scale;\n        }\n        var xpositionEnds = (location['x'] + transPoint['x']) * scale + textSize['width'] / 2;\n        var xpositionStart = (location['x'] + transPoint['x']) * scale - textSize['width'] / 2;\n        _this.value[index] = {\n          rightWidth: xpositionEnds,\n          leftWidth: xpositionStart,\n          heightTop: start,\n          heightBottom: end\n        };\n        var labelElement;\n        if (eventargs_1.template !== '') {\n          templateFn = getTemplateFunction(eventargs_1.template, _this.maps);\n          var templateElement = templateFn ? templateFn(!isNullOrUndefined(datasrcObj) ? datasrcObj : shapeData['properties'], _this.maps, eventargs_1.template, _this.maps.element.id + '_LabelTemplate', false) : document.createElement('div');\n          templateElement.innerHTML = !templateFn ? eventargs_1.template : '';\n          labelElement = convertElementFromLabel(templateElement, labelId, !isNullOrUndefined(datasrcObj) ? datasrcObj : shapeData['properties'], index, _this.maps);\n          labelElement.style.left = Math.abs(_this.maps.baseMapRectBounds['min']['x'] - location['x']) * scale + labelArgs.offsetX + 'px';\n          labelElement.style.top = Math.abs(_this.maps.baseMapRectBounds['min']['y'] - location['y']) * scale + labelArgs.offsetY + 'px';\n          labelTemplateElement.appendChild(labelElement);\n        } else {\n          if (dataLabelSettings.smartLabelMode === 'Trim') {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var textType = typeof text === 'number' ? text.toString() : text;\n            trimmedLable = textTrim(width, textType, style);\n            elementSize = measureText(trimmedLable, style);\n            options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', trimmedLable, '', '');\n          }\n          if (dataLabelSettings.smartLabelMode === 'None') {\n            options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', text, '', '');\n          }\n          if (dataLabelSettings.smartLabelMode === 'Hide') {\n            text = width >= textSize['width'] ? text : '';\n            options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', text, '', '');\n          }\n          text = options['text'];\n          if (dataLabelSettings.intersectionAction === 'Hide') {\n            for (var i = 0; i < intersect.length; i++) {\n              if (!isNullOrUndefined(intersect[i])) {\n                if (!(_this.value[index]['leftWidth'] > intersect[i]['rightWidth'] || _this.value[index]['rightWidth'] < intersect[i]['leftWidth'] || _this.value[index]['heightTop'] > intersect[i]['heightBottom'] || _this.value[index]['heightBottom'] < intersect[i]['heightTop'])) {\n                  text = '';\n                  break;\n                }\n              }\n            }\n            intersect.push(_this.value[index]);\n            options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', text, '', '');\n          }\n          var difference = void 0;\n          if (dataLabelSettings.intersectionAction === 'Trim') {\n            for (var j = 0; j < intersect.length; j++) {\n              if (!isNullOrUndefined(intersect[j])) {\n                if (intersect[j]['rightWidth'] < _this.value[index]['leftWidth'] || intersect[j]['leftWidth'] > _this.value[index]['rightWidth'] || intersect[j]['heightBottom'] < _this.value[index]['heightTop'] || intersect[j]['heightTop'] > _this.value[index]['heightBottom']) {\n                  trimmedLable = text;\n                  difference = 0;\n                } else {\n                  if (_this.value[index]['leftWidth'] > intersect[j]['leftWidth']) {\n                    width = intersect[j]['rightWidth'] - _this.value[index]['leftWidth'];\n                    difference = width - (_this.value[index]['rightWidth'] - _this.value[index]['leftWidth']);\n                    trimmedLable = textTrim(difference, text, style);\n                    break;\n                  }\n                  if (_this.value[index]['leftWidth'] < intersect[j]['leftWidth']) {\n                    width = _this.value[index]['rightWidth'] - intersect[j]['leftWidth'];\n                    difference = Math.abs(width - (_this.value[index]['rightWidth'] - _this.value[index]['leftWidth']));\n                    trimmedLable = textTrim(difference, text, style);\n                    break;\n                  }\n                }\n              }\n            }\n            elementSize = measureText(trimmedLable, style);\n            intersect.push(_this.value[index]);\n            options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', trimmedLable, '', '');\n          }\n          if (dataLabelSettings.intersectionAction === 'None') {\n            options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', text, '', '');\n          }\n          if (trimmedLable.length > 1) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var border_1 = eventargs_1.border;\n            if (border_1['width'] > 1) {\n              var fill = eventargs_1.fill;\n              var opacity = dataLabelSettings.opacity;\n              var rx = dataLabelSettings.rx;\n              var ry = dataLabelSettings.ry;\n              var x = void 0;\n              var y = void 0;\n              var padding = 5;\n              if (zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied) {\n                x = location['x'] - textSize['width'] / 2;\n                y = location['y'] - textSize['height'] / 2 - padding;\n              } else {\n                x = (location['x'] + transPoint['x']) * scale - textSize['width'] / 2;\n                y = (location['y'] + transPoint['y']) * scale - textSize['height'] / 2;\n              }\n              border_1.opacity = isNullOrUndefined(border_1.opacity) ? opacity : border_1.opacity;\n              var rectOptions = new RectOption(_this.maps.element.id + '_LayerIndex_' + layerIndex + '_shapeIndex_' + index + '_rectIndex_' + index, fill, border_1, opacity, new Rect(x + labelArgs.offsetX, y + labelArgs.offsetY, textSize['width'], textSize['height']), rx, ry);\n              var rect = _this.maps.renderer.drawRectangle(rectOptions);\n              group.appendChild(rect);\n            }\n          }\n          element = renderTextElement(options, style, style.color || _this.maps.themeStyle.dataLabelFontColor, group);\n          if (zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied) {\n            element.setAttribute('transform', 'translate( ' + (location['x'] + labelArgs.offsetX) + ' ' + (location['y'] + labelArgs.offsetY) + ' )');\n            location['x'] = locationX;\n            location['y'] = locationY;\n          } else {\n            element.setAttribute('transform', 'translate( ' + ((location['x'] + transPoint.x) * scale + labelArgs.offsetX) + ' ' + ((location['y'] + transPoint.y) * scale + elementSize.height / 4 + labelArgs.offsetY) + ' )');\n          }\n          group.appendChild(element);\n        }\n        _this.dataLabelCollections.push({\n          location: {\n            x: location['x'] + labelArgs.offsetX,\n            y: location['y'] + labelArgs.offsetY\n          },\n          element: isNullOrUndefined(labelElement) ? element : labelElement,\n          layerIndex: layerIndex,\n          shapeIndex: sublayerIndexLabel ? oldIndex : index,\n          labelIndex: sublayerIndexLabel ? oldIndex : index,\n          dataLabelText: dataLabelText\n        });\n        if (labelTemplateElement.childElementCount > 0 && !_this.maps.element.contains(labelTemplateElement)) {\n          document.getElementById(_this.maps.element.id + '_Secondary_Element').appendChild(labelTemplateElement);\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          _this.maps.renderReactTemplates();\n        }\n      });\n    }\n  };\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  DataLabel.prototype.getPoint = function (shapes, points) {\n    if (shapes['type'] === 'MultiLineString') {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      shapes.map(function (current) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        current.map(function (shape) {\n          points.push(new Point(shape['point']['x'], shape['point']['y']));\n        });\n      });\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      shapes.map(function (current, index) {\n        points.push(new Point(current['point']['x'], current['point']['y']));\n      });\n    }\n    return points;\n  };\n  /**\n   * Get module name.\n   *\n   * @returns {string} - Returns the module name.\n   */\n  DataLabel.prototype.getModuleName = function () {\n    return 'DataLabel';\n  };\n  /**\n   *\n   * @returns {void}\n   * @private\n   */\n  DataLabel.prototype.destroy = function () {\n    this.dataLabelCollections = [];\n    this.value = null;\n    this.maps = null;\n  };\n  return DataLabel;\n}();\nexport { DataLabel };","map":{"version":3,"names":["findMidPointOfPolygon","Rect","filter","getTemplateFunction","getZoomTranslate","getTranslate","RectOption","convertElementFromLabel","Point","TextOption","renderTextElement","textTrim","measureText","Internalize","isNullOrUndefined","dataLabelRendering","DataLabel","maps","value","rightWidth","leftWidth","heightTop","heightBottom","dataLabelCollections","prototype","getDataLabel","dataSource","labelPath","shapeName","shapeDataPath","text","shapeNameValue","i","length","data","dataShapePathValue","isNaN","toLowerCase","toString","renderLabel","layer","layerIndex","shape","layerData","group","labelTemplateElement","index","intersect","_this","dataLabel","dataLabelSettings","style","textStyle","markerEle","templateFn","options","labelpath","shapePoint","midIndex","pointsLength","shapeData","element","datasrcObj","currentLength","oldIndex","location","sublayerIndexLabel","shapeProperties","labelId","id","textLocation","shapes","locationX","locationY","fontFamily","theme","themeStyle","labelFontFamily","properties","Object","call","shapePropertyPath","propertyPath","isPoint","animate","animationDuration","zoomModule","translate","isTileMap","zoomSettings","zoomFactor","scale","transPoint","translatePoint","zoomTransPoint","zoomTranslatePoint","shapeWidth","scaleZoomValue","Math","floor","zoomLabelsPosition","enable","zoomShapeCollection","isAddLayer","translateType","j","push","getPoint","layer_1","l","template","dataLabelText","projectionType","x","y","rightMin","rightMax","leftMin","leftMax","points","topMax","topMin","bottomMax","bottomMin","height","geometryType","firstLevelMapLocation","zoomNotApplied","k","zoomLabelPositions","format","parseFloat","useGroupingSeparator","eventargs_1","name","cancel","border","color","width","opacity","datalabel","fill","offsetX","offsetY","trigger","labelArgs","position","dataLabelShape","textSize","trimmedLable","elementSize","startY","endY","start","end","location1","xpositionEnds","xpositionStart","labelElement","templateElement","document","createElement","innerHTML","left","abs","baseMapRectBounds","top","appendChild","smartLabelMode","textType","intersectionAction","difference","border_1","rx","ry","padding","rectOptions","rect","renderer","drawRectangle","dataLabelFontColor","setAttribute","shapeIndex","labelIndex","childElementCount","contains","getElementById","renderReactTemplates","map","current","getModuleName","destroy"],"sources":["/Users/macbookpro16/Desktop/cs222/client/node_modules/@syncfusion/ej2-maps/src/maps/layers/data-label.js"],"sourcesContent":["import { findMidPointOfPolygon, Rect, filter, getTemplateFunction, getZoomTranslate, getTranslate, RectOption, convertElementFromLabel, Point, TextOption, renderTextElement, textTrim, measureText, Internalize } from '../utils/helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { dataLabelRendering } from '../model/constants';\n/**\n * DataLabel Module used to render the maps datalabel\n */\nvar DataLabel = /** @class */ (function () {\n    function DataLabel(maps) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.value = { rightWidth: 0, leftWidth: 0, heightTop: 0, heightBottom: 0 };\n        this.maps = maps;\n        this.dataLabelCollections = [];\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    DataLabel.prototype.getDataLabel = function (dataSource, labelPath, shapeName, shapeDataPath) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var text;\n        var shapeNameValue;\n        for (var i = 0; i < dataSource.length; i++) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var data = dataSource[i];\n            var dataShapePathValue = !isNullOrUndefined(data[shapeDataPath]) && isNaN(data[shapeDataPath]) &&\n                typeof data[shapeDataPath] === 'string' ? data[shapeDataPath].toLowerCase() : data[shapeDataPath];\n            shapeName = !isNullOrUndefined(shapeName) && typeof shapeName === 'string' ? shapeName.toString() : shapeName;\n            shapeNameValue = !isNullOrUndefined(shapeName) && typeof shapeName === 'string' ? shapeName.toLowerCase() : shapeName;\n            if ((dataShapePathValue) === shapeNameValue) {\n                text = data;\n                break;\n            }\n        }\n        return text;\n    };\n    /**\n     * To render label for maps\n     *\n     * @param {LayerSettings} layer - Specifies the layer settings\n     * @param {number} layerIndex - Specifies the layer index.\n     * @param {any} shape - Specifies the shape.\n     * @param {any[]} layerData - Specifies the layer data.\n     * @param {Element} group Specifies the element.\n     * @param {HTMLElement} labelTemplateElement - Specifies the template element.\n     * @param {number} index - Specifies the index number.\n     * @param {any[]} intersect - Specifies the intersect.\n     * @returns {void}\n     */\n    DataLabel.prototype.renderLabel = function (\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    layer, layerIndex, shape, \n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    layerData, group, labelTemplateElement, index, intersect) {\n        var _this = this;\n        var dataLabel = layer.dataLabelSettings;\n        var style = layer.dataLabelSettings.textStyle;\n        var markerEle;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var templateFn;\n        var options;\n        var dataLabelSettings = layer.dataLabelSettings;\n        var labelpath = layer.dataLabelSettings.labelPath;\n        var shapePoint = [[]];\n        var midIndex = 0;\n        var pointsLength = 0;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var shapeData = shape;\n        var element;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var data;\n        var text = '';\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var datasrcObj;\n        var currentLength = 0;\n        var oldIndex;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var location;\n        var sublayerIndexLabel = false;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var shapeProperties = shape['properties'];\n        var labelId = this.maps.element.id + '_LayerIndex_' + layerIndex + '_shapeIndex_' + index + '_LabelIndex_' + index;\n        var textLocation = new Point(0, 0);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var shapes = layerData[index];\n        var locationX;\n        var locationY;\n        style.fontFamily = this.maps.theme.toLowerCase() !== 'material' ? this.maps.themeStyle.labelFontFamily : style.fontFamily;\n        shape = shapes['property'];\n        var properties = (Object.prototype.toString.call(layer.shapePropertyPath) === '[object Array]' ?\n            layer.shapePropertyPath : [layer.shapePropertyPath]);\n        var propertyPath;\n        var isPoint = false;\n        var animate = layer.animationDuration !== 0 || isNullOrUndefined(this.maps.zoomModule);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var translate = (this.maps.isTileMap) ? new Object() : ((this.maps.zoomSettings.zoomFactor > 1 &&\n            !isNullOrUndefined(this.maps.zoomModule)) ? getZoomTranslate(this.maps, layer, animate) :\n            getTranslate(this.maps, layer, animate));\n        var scale = (this.maps.isTileMap) ? this.maps.scale : translate['scale'];\n        var transPoint = (this.maps.isTileMap) ? this.maps.translatePoint : translate['location'];\n        var zoomTransPoint = this.maps.zoomTranslatePoint;\n        var shapeWidth;\n        var scaleZoomValue = !isNullOrUndefined(this.maps.scale) ? Math.floor(this.maps.scale) : 1;\n        var zoomLabelsPosition = this.maps.zoomSettings.enable ? !isNullOrUndefined(this.maps.zoomShapeCollection) &&\n            this.maps.zoomShapeCollection.length > 0 && !this.maps.isAddLayer : this.maps.zoomSettings.enable;\n        this.maps.translateType = 'labels';\n        for (var j = 0; j < properties.length; j++) {\n            if (shapeProperties[properties[j]]) {\n                propertyPath = properties[j];\n                datasrcObj = this.getDataLabel(\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                layer.dataSource, layer.shapeDataPath, shapeData['properties'][propertyPath], layer.shapeDataPath);\n                if (datasrcObj) {\n                    break;\n                }\n            }\n        }\n        datasrcObj = this.getDataLabel(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        layer.dataSource, layer.shapeDataPath, shapeData['properties'][propertyPath], layer.shapeDataPath);\n        if (!isNullOrUndefined(shapes['property'])) {\n            shapePoint = [[]];\n            if (!layerData[index]['_isMultiPolygon'] && layerData[index]['type'] !== 'Point' && layerData[index]['type'] !== 'MultiPoint') {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                shapePoint.push(this.getPoint(layerData[index], []));\n                currentLength = shapePoint[shapePoint.length - 1].length;\n                if (pointsLength < currentLength) {\n                    pointsLength = currentLength;\n                    midIndex = shapePoint.length - 1;\n                }\n            }\n            else if (layerData[index]['type'] !== 'Point' && layerData[index]['type'] !== 'MultiPoint') {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var layer_1 = layerData[index];\n                for (var j = 0; j < layer_1.length; j++) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    shapePoint.push(this.getPoint(layer_1[j], []));\n                    currentLength = shapePoint[shapePoint.length - 1].length;\n                    if (pointsLength < currentLength) {\n                        pointsLength = currentLength;\n                        midIndex = shapePoint.length - 1;\n                    }\n                }\n            }\n        }\n        text = (!isNullOrUndefined(datasrcObj)) ? !isNullOrUndefined(datasrcObj[labelpath]) ?\n            datasrcObj[labelpath].toString() : datasrcObj[layer.shapeDataPath] : shapeData['properties'][labelpath];\n        if ((Object.prototype.toString.call(layer.shapePropertyPath) === '[object Array]') &&\n            (isNullOrUndefined(text) && layer.dataSource['length'] === 0)) {\n            for (var l = 0; l < layer.shapePropertyPath.length; l++) {\n                if (shapeData['properties'][layer.shapePropertyPath[l]]) {\n                    text = shapeData['properties'][layer.shapePropertyPath[l]];\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(text) && (layer.dataLabelSettings.template !== '' && layer.dataSource['length'] === 0)) {\n            text = shapeData['properties'][layer.shapePropertyPath];\n        }\n        var dataLabelText = text;\n        var projectionType = this.maps.projectionType;\n        if (isPoint) {\n            location = {\n                x: shapePoint[midIndex][index]['x'], y: shapePoint[midIndex][index]['y'],\n                rightMin: 0, rightMax: 0, leftMin: 0, leftMax: 0,\n                points: shapePoint[midIndex][index], topMax: 0, topMin: 0,\n                bottomMax: 0, bottomMin: 0, height: 0\n            };\n        }\n        else {\n            location = findMidPointOfPolygon(shapePoint[midIndex], projectionType, layer.geometryType);\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var firstLevelMapLocation = location;\n        if (!isNullOrUndefined(text) && !isNullOrUndefined(location)) {\n            if (zoomLabelsPosition && scaleZoomValue > 1 && !this.maps.zoomNotApplied && dataLabel.template === '') {\n                if (layerIndex > 0) {\n                    for (var k = 0; k < this.maps.zoomLabelPositions.length; k++) {\n                        if (this.maps.zoomLabelPositions[k]['dataLabelText'] === text) {\n                            oldIndex = index;\n                            index = k;\n                            sublayerIndexLabel = true;\n                            break;\n                        }\n                    }\n                }\n                locationX = location['x'];\n                locationY = location['y'];\n                location['x'] = ((location['x'] + zoomTransPoint['x']) * scale);\n                location['y'] = ((location['y'] + zoomTransPoint['y']) * scale);\n            }\n            location['y'] = (this.maps.projectionType === 'Mercator') || layer.geometryType === 'Normal' ? location['y'] : (-location['y']);\n            data = location;\n            if (!isNullOrUndefined(this.maps.format) && !isNaN(parseFloat(text))) {\n                if (this.maps.useGroupingSeparator) {\n                    text = Internalize(this.maps, parseFloat(text));\n                    if (!isNullOrUndefined(datasrcObj)) {\n                        datasrcObj[labelpath] = text;\n                    }\n                }\n            }\n            var eventargs_1 = {\n                name: dataLabelRendering, maps: this.maps, cancel: false, border: { color: dataLabel.border.color,\n                    width: dataLabel.border.width, opacity: dataLabel.border.opacity }, datalabel: dataLabel,\n                fill: dataLabel.fill, template: dataLabel.template, text: text, offsetX: 0, offsetY: 0\n            };\n            this.maps.trigger('dataLabelRendering', eventargs_1, function (labelArgs) {\n                if (eventargs_1.cancel) {\n                    return;\n                }\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var border = { color: 'yellow' };\n                var position = [];\n                var width = zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied\n                    && _this.maps.zoomShapeCollection.length > index ? _this.maps.zoomShapeCollection[index]['width'] :\n                    (location['rightMax']['x'] - location['leftMax']['x']) * scale;\n                if (!isNullOrUndefined(_this.maps.dataLabelShape)) {\n                    shapeWidth = firstLevelMapLocation['rightMax']['x'] - firstLevelMapLocation['leftMax']['x'];\n                    _this.maps.dataLabelShape.push(shapeWidth);\n                }\n                if (eventargs_1.text !== text && !eventargs_1.cancel) {\n                    text = eventargs_1.text;\n                }\n                var textSize = measureText(text, style);\n                var trimmedLable = text;\n                var elementSize = textSize;\n                var startY = location['y'] - textSize['height'] / 4;\n                var endY = location['y'] + textSize['height'] / 4;\n                var start = ((location['y'] + transPoint['y']) * scale) - textSize['height'] / 4;\n                var end = ((location['y'] + transPoint['y']) * scale) + textSize['height'] / 4;\n                position = filter(shapePoint[midIndex], startY, endY);\n                if (!isPoint && position.length > 5 && (shapeData['geometry']['type'] !== 'MultiPolygon') &&\n                    (shapeData['type'] !== 'MultiPolygon')) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    var location1 = findMidPointOfPolygon(position, projectionType, layer.geometryType);\n                    if (zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied && eventargs_1.template === '') {\n                        location1['x'] = ((_this.maps.zoomLabelPositions[index]['location']['x'] + zoomTransPoint['x']) * scale);\n                        location1['y'] = ((_this.maps.zoomLabelPositions[index]['location']['y'] + zoomTransPoint['y']) * scale);\n                    }\n                    locationX = location1['x'];\n                    location['x'] = location1['x'];\n                    width = zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied\n                        && _this.maps.zoomShapeCollection.length > index ? _this.maps.zoomShapeCollection[index]['width'] :\n                        (location1['rightMax']['x'] - location1['leftMax']['x']) * scale;\n                }\n                var xpositionEnds = ((location['x'] + transPoint['x']) * scale) + textSize['width'] / 2;\n                var xpositionStart = ((location['x'] + transPoint['x']) * scale) - textSize['width'] / 2;\n                _this.value[index] = { rightWidth: xpositionEnds, leftWidth: xpositionStart, heightTop: start, heightBottom: end };\n                var labelElement;\n                if (eventargs_1.template !== '') {\n                    templateFn = getTemplateFunction(eventargs_1.template, _this.maps);\n                    var templateElement = templateFn ? templateFn(!isNullOrUndefined(datasrcObj) ?\n                        datasrcObj : shapeData['properties'], _this.maps, eventargs_1.template, _this.maps.element.id + '_LabelTemplate', false) : document.createElement('div');\n                    templateElement.innerHTML = !templateFn ? eventargs_1.template : '';\n                    labelElement = convertElementFromLabel(templateElement, labelId, !isNullOrUndefined(datasrcObj) ? datasrcObj : shapeData['properties'], index, _this.maps);\n                    labelElement.style.left = ((Math.abs(_this.maps.baseMapRectBounds['min']['x'] - location['x'])) * scale) + labelArgs.offsetX + 'px';\n                    labelElement.style.top = ((Math.abs(_this.maps.baseMapRectBounds['min']['y'] - location['y'])) * scale) + labelArgs.offsetY + 'px';\n                    labelTemplateElement.appendChild(labelElement);\n                }\n                else {\n                    if (dataLabelSettings.smartLabelMode === 'Trim') {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        var textType = typeof text === 'number' ? text.toString() : text;\n                        trimmedLable = textTrim(width, textType, style);\n                        elementSize = measureText(trimmedLable, style);\n                        options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', trimmedLable, '', '');\n                    }\n                    if (dataLabelSettings.smartLabelMode === 'None') {\n                        options = new TextOption(labelId, (textLocation.x), textLocation.y, 'middle', text, '', '');\n                    }\n                    if (dataLabelSettings.smartLabelMode === 'Hide') {\n                        text = (width >= textSize['width']) ? text : '';\n                        options = new TextOption(labelId, (textLocation.x), (textLocation.y), 'middle', text, '', '');\n                    }\n                    text = options['text'];\n                    if (dataLabelSettings.intersectionAction === 'Hide') {\n                        for (var i = 0; i < intersect.length; i++) {\n                            if (!isNullOrUndefined(intersect[i])) {\n                                if (!(_this.value[index]['leftWidth'] > intersect[i]['rightWidth']\n                                    || _this.value[index]['rightWidth'] < intersect[i]['leftWidth']\n                                    || _this.value[index]['heightTop'] > intersect[i]['heightBottom']\n                                    || _this.value[index]['heightBottom'] < intersect[i]['heightTop'])) {\n                                    text = '';\n                                    break;\n                                }\n                            }\n                        }\n                        intersect.push(_this.value[index]);\n                        options = new TextOption(labelId, textLocation.x, textLocation.y, 'middle', text, '', '');\n                    }\n                    var difference = void 0;\n                    if (dataLabelSettings.intersectionAction === 'Trim') {\n                        for (var j = 0; j < intersect.length; j++) {\n                            if (!isNullOrUndefined(intersect[j])) {\n                                if (intersect[j]['rightWidth'] < _this.value[index]['leftWidth']\n                                    || intersect[j]['leftWidth'] > _this.value[index]['rightWidth']\n                                    || intersect[j]['heightBottom'] < _this.value[index]['heightTop']\n                                    || intersect[j]['heightTop'] > _this.value[index]['heightBottom']) {\n                                    trimmedLable = text;\n                                    difference = 0;\n                                }\n                                else {\n                                    if (_this.value[index]['leftWidth'] > intersect[j]['leftWidth']) {\n                                        width = intersect[j]['rightWidth'] - _this.value[index]['leftWidth'];\n                                        difference = width - (_this.value[index]['rightWidth'] - _this.value[index]['leftWidth']);\n                                        trimmedLable = textTrim(difference, text, style);\n                                        break;\n                                    }\n                                    if (_this.value[index]['leftWidth'] < intersect[j]['leftWidth']) {\n                                        width = _this.value[index]['rightWidth'] - intersect[j]['leftWidth'];\n                                        difference = Math.abs(width - (_this.value[index]['rightWidth'] - _this.value[index]['leftWidth']));\n                                        trimmedLable = textTrim(difference, text, style);\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                        elementSize = measureText(trimmedLable, style);\n                        intersect.push(_this.value[index]);\n                        options = new TextOption(labelId, textLocation.x, (textLocation.y), 'middle', trimmedLable, '', '');\n                    }\n                    if (dataLabelSettings.intersectionAction === 'None') {\n                        options = new TextOption(labelId, (textLocation.x), (textLocation.y), 'middle', text, '', '');\n                    }\n                    if (trimmedLable.length > 1) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        var border_1 = eventargs_1.border;\n                        if (border_1['width'] > 1) {\n                            var fill = eventargs_1.fill;\n                            var opacity = dataLabelSettings.opacity;\n                            var rx = dataLabelSettings.rx;\n                            var ry = dataLabelSettings.ry;\n                            var x = void 0;\n                            var y = void 0;\n                            var padding = 5;\n                            if (zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied) {\n                                x = ((location['x'])) - textSize['width'] / 2;\n                                y = ((location['y'])) - textSize['height'] / 2 - padding;\n                            }\n                            else {\n                                x = ((location['x'] + transPoint['x']) * scale) - textSize['width'] / 2;\n                                y = ((location['y'] + transPoint['y']) * scale) - textSize['height'] / 2;\n                            }\n                            border_1.opacity = isNullOrUndefined(border_1.opacity) ? opacity : border_1.opacity;\n                            var rectOptions = new RectOption(_this.maps.element.id + '_LayerIndex_' + layerIndex + '_shapeIndex_' + index + '_rectIndex_' + index, fill, border_1, opacity, new Rect((x + labelArgs.offsetX), (y + labelArgs.offsetY), textSize['width'], textSize['height']), rx, ry);\n                            var rect = _this.maps.renderer.drawRectangle(rectOptions);\n                            group.appendChild(rect);\n                        }\n                    }\n                    element = renderTextElement(options, style, style.color || _this.maps.themeStyle.dataLabelFontColor, group);\n                    if (zoomLabelsPosition && scaleZoomValue > 1 && !_this.maps.zoomNotApplied) {\n                        element.setAttribute('transform', 'translate( ' + ((location['x'] + labelArgs.offsetX)) + ' '\n                            + (((location['y'] + labelArgs.offsetY))) + ' )');\n                        location['x'] = locationX;\n                        location['y'] = locationY;\n                    }\n                    else {\n                        element.setAttribute('transform', 'translate( ' + (((location['x'] + transPoint.x) * scale) + labelArgs.offsetX) + ' '\n                            + ((((location['y'] + transPoint.y) * scale) + (elementSize.height / 4)) + labelArgs.offsetY) + ' )');\n                    }\n                    group.appendChild(element);\n                }\n                _this.dataLabelCollections.push({\n                    location: { x: location['x'] + labelArgs.offsetX, y: location['y'] + labelArgs.offsetY },\n                    element: isNullOrUndefined(labelElement) ? element : labelElement,\n                    layerIndex: layerIndex,\n                    shapeIndex: sublayerIndexLabel ? oldIndex : index,\n                    labelIndex: sublayerIndexLabel ? oldIndex : index,\n                    dataLabelText: dataLabelText\n                });\n                if (labelTemplateElement.childElementCount > 0 && !_this.maps.element.contains(labelTemplateElement)) {\n                    document.getElementById(_this.maps.element.id + '_Secondary_Element').appendChild(labelTemplateElement);\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    _this.maps.renderReactTemplates();\n                }\n            });\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    DataLabel.prototype.getPoint = function (shapes, points) {\n        if (shapes['type'] === 'MultiLineString') {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            shapes.map(function (current) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                current.map(function (shape) {\n                    points.push(new Point(shape['point']['x'], shape['point']['y']));\n                });\n            });\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            shapes.map(function (current, index) {\n                points.push(new Point(current['point']['x'], current['point']['y']));\n            });\n        }\n        return points;\n    };\n    /**\n     * Get module name.\n     *\n     * @returns {string} - Returns the module name.\n     */\n    DataLabel.prototype.getModuleName = function () {\n        return 'DataLabel';\n    };\n    /**\n     *\n     * @returns {void}\n     * @private\n     */\n    DataLabel.prototype.destroy = function () {\n        this.dataLabelCollections = [];\n        this.value = null;\n        this.maps = null;\n    };\n    return DataLabel;\n}());\nexport { DataLabel };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}